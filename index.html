<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>免費英文打字練習 | A2-C1級別線上英語打字訓練 | English Typing Practice</title>
    <meta name="description" content="免費線上英文打字練習工具，提供A2-C1級別英語句子練習。提升英文打字速度與準確率，包含中文翻譯與重點單字解釋。適合英語學習者、學生、上班族使用。">
    <meta name="keywords" content="英文打字, 英語打字練習, 線上打字, 免費打字練習, English typing, 打字速度測試, WPM測試, 英語學習, A2 B1 B2 C1, 英文練習">
    <meta name="author" content="English Typing Practice">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="免費英文打字練習 | A2-C1級別線上英語打字訓練">
    <meta property="og:description" content="免費線上英文打字練習工具，提供A2-C1級別英語句子練習。提升英文打字速度與準確率，包含中文翻譯與重點單字解釋。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ben0126.github.io/english_typing_practice/">
    <meta property="og:image" content="https://ben0126.github.io/english_typing_practice/og-image.jpg">
    <meta property="og:locale" content="zh_TW">
    <meta property="og:site_name" content="English Typing Practice">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="免費英文打字練習 | A2-C1級別線上英語打字訓練">
    <meta name="twitter:description" content="免費線上英文打字練習工具，提供A2-C1級別英語句子練習。提升英文打字速度與準確率。">
    <meta name="twitter:image" content="https://ben0126.github.io/english_typing_practice/twitter-image.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://ben0126.github.io/english_typing_practice/">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "英文打字練習",
        "description": "免費線上英文打字練習工具，提供B1-C1級別英語句子練習",
        "url": "https://ben0126.github.io/english_typing_practice/",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "English Typing Practice"
        },
        "browserRequirements": "Requires JavaScript",
        "softwareVersion": "1.0",
        "isAccessibleForFree": true,
        "educationalLevel": "Intermediate to Advanced",
        "teaches": ["English Typing", "English Language", "Keyboard Skills"],
        "audience": {
            "@type": "EducationalAudience",
            "educationalRole": "student"
        }
    }
    </script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#4CAF50">
    <meta name="msapplication-TileColor" content="#4CAF50">
    <meta name="msapplication-config" content="browserconfig.xml">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Inter:wght@400;500;600&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-gradient: linear-gradient(45deg, #4CAF50, #45a049);
            --secondary-gradient: linear-gradient(45deg, #2196F3, #1976D2);
            --background-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --progress-gradient: linear-gradient(90deg, #4CAF50, #45a049);
        }

        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background: var(--background-gradient);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: var(--primary-gradient);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .header .subtitle {
            font-size: 1em;
            opacity: 0.8;
            font-weight: 400;
        }

        .benefits {
            background: rgba(255,255,255,0.1);
            margin: 15px 0;
            padding: 15px;
            border-radius: 10px;
            font-size: 0.9em;
        }

        .benefits ul {
            list-style: none;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
        }

        .benefits li:before {
            content: "✓ ";
            color: #a8e6cf;
            font-weight: bold;
        }

        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filters {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filters select {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            transition: border-color 0.3s;
            min-width: 120px;
        }

        .filters select:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .filters select:hover {
            border-color: #4CAF50;
        }

        .difficulty-selector {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .difficulty-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            background: #e0e0e0;
            color: #333;
            font-weight: 500;
        }

        .difficulty-btn.active {
            background: #4CAF50;
            color: white;
            transform: scale(1.05);
        }

        .display-options {
            display: flex;
            gap: 8px;
            margin-left: 20px;
        }

        .display-btn {
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            background: #f5f5f5;
            color: #666;
            font-weight: 500;
        }

        .display-btn:hover {
            background: #e0e0e0;
            border-color: #bbb;
        }

        .display-btn.active {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-left: auto;
            font-size: 14px;
            color: #666;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #4CAF50;
        }

        .practice-area {
            padding: 30px;
        }

        .sentence-display {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid #4CAF50;
        }

        .sentence {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 10px;
            user-select: none;
            font-family: 'Inter', sans-serif;
        }

        .char {
            position: relative;
        }

        .char.correct {
            background-color: #c8e6c9;
            color: #2e7d32;
        }

        .char.incorrect {
            background-color: #ffcdd2;
            color: #c62828;
        }

        .char.current {
            background-color: #2196F3;
            color: white;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .audio-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 15px 0;
        }

        .audio-btn {
            background: var(--secondary-gradient);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }

        .audio-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(33, 150, 243, 0.3);
        }

        .audio-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .audio-btn.playing {
            background: var(--primary-gradient);
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #666;
        }

        .speed-slider {
            width: 80px;
            height: 4px;
            border-radius: 2px;
            background: #ddd;
            outline: none;
            cursor: pointer;
        }

        .translation {
            font-size: 14px;
            color: #666;
            font-style: italic;
            margin-top: 8px;
        }

        .input-area {
            position: relative;
        }

        .typing-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            line-height: 1.6;
            resize: none;
            outline: none;
            transition: border-color 0.3s;
            font-family: 'Courier New', monospace;
        }

        .typing-input:focus {
            border-color: #4CAF50;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--progress-gradient);
            width: 0%;
            transition: width 0.3s ease;
        }

        .vocabulary {
            margin-top: 20px;
            padding: 20px;
            background: #fff3e0;
            border-radius: 10px;
            border-left: 4px solid #ff9800;
        }

        .vocab-title {
            font-size: 16px;
            font-weight: bold;
            color: #e65100;
            margin-bottom: 10px;
        }

        .vocab-item {
            margin-bottom: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .vocab-word {
            font-weight: bold;
            color: #d84315;
            cursor: pointer;
            text-decoration: underline;
            text-decoration-style: dotted;
        }

        .vocab-word:hover {
            color: #2196F3;
        }

        .word-audio-btn {
            background: #e3f2fd;
            border: none;
            border-radius: 12px;
            padding: 2px 6px;
            cursor: pointer;
            font-size: 12px;
            color: #1976D2;
            transition: all 0.2s;
        }

        .word-audio-btn:hover {
            background: #2196F3;
            color: white;
        }

        .next-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px auto;
            display: block;
            transition: transform 0.3s;
            font-weight: 500;
        }

        .next-btn:hover {
            transform: translateY(-2px);
        }

        .next-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .feedback {
            text-align: center;
            margin: 10px 0;
            font-size: 16px;
            font-weight: bold;
        }

        .feedback.excellent { color: #4CAF50; }
        .feedback.good { color: #2196F3; }
        .feedback.fair { color: #FF9800; }
        .feedback.poor { color: #f44336; }

        .features {
            background: #f8f9fa;
            padding: 30px;
            margin-top: 20px;
        }

        .features h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
            font-size: 1.8em;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }

        .feature-card h3 {
            color: #4CAF50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .feature-card p {
            color: #666;
            font-size: 0.9em;
        }

        .footer {
            background: #333;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 0.9em;
        }

        .footer p {
            margin-bottom: 5px;
        }

        .footer a {
            color: #4CAF50;
            text-decoration: none;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .stats {
                margin-left: 0;
                justify-content: center;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus indicators */
        .audio-btn:focus,
        .difficulty-btn:focus,
        .next-btn:focus,
        .word-audio-btn:focus {
            outline: 3px solid #2196F3;
            outline-offset: 2px;
        }

        .speed-slider:focus {
            outline: 3px solid #4CAF50;
            outline-offset: 2px;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .char.correct {
                background-color: #000;
                color: #fff;
            }
            
            .char.incorrect {
                background-color: #fff;
                color: #000;
                border: 2px solid #000;
            }
            
            .char.current {
                background-color: #0000ff;
                color: #fff;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            .char.current {
                animation: none;
                background-color: #1976D2;
            }
            
            .next-btn:hover,
            .audio-btn:hover {
                transform: none;
            }
            
            * {
                transition: none !important;
                animation: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🎯 免費英文打字練習</h1>
            <p>English Typing Practice | A2-C1 Level | 提升英語打字速度與準確率</p>
        </header>

        <nav class="controls" role="navigation" aria-label="練習設定">
            <div class="difficulty-selector">
                <span>選擇難度:</span>
                <button class="difficulty-btn" data-level="all" aria-label="選擇所有難度">所有難度</button>
                <button class="difficulty-btn" data-level="A2" aria-label="選擇A2初中級難度">A2 初中級</button>
                <button class="difficulty-btn" data-level="B1" aria-label="選擇B1中級難度">B1 中級</button>
                <button class="difficulty-btn active" data-level="B2" aria-label="選擇B2中高級難度">B2 中高級</button>
                <button class="difficulty-btn" data-level="C1" aria-label="選擇C1高級難度">C1 高級</button>
                
                <div class="speed-control" role="group" aria-label="語速控制">
                    <label for="speed-slider">語速:</label>
                    <input type="range" class="speed-slider" id="speed-slider" min="0.3" max="1.5" step="0.1" value="1.0" aria-describedby="speed-value">
                    <span id="speed-value" aria-live="polite">1.0x</span>
                </div>
                
                <div class="display-options" role="group" aria-label="顯示選項">
                    <button class="display-btn" id="hide-chinese" aria-label="隱藏中文翻譯">隱藏中文</button>
                    <button class="display-btn" id="hide-english" aria-label="隱藏英文句子">隱藏英文</button>
                </div>
            </div>
            
            <div class="filters">
                <select id="contextFilter" aria-label="選擇情境過濾">
                    <option value="all">所有情境</option>
                    <option value="日常對話">日常對話</option>
                    <option value="學術">學術</option>
                    <option value="商務">商務</option>
                    <option value="旅遊">旅遊</option>
                    <option value="科技">科技</option>
                    <option value="文法">文法練習</option>
                    <option value="片語">片語練習</option>
                </select>
            </div>
            
            <div class="stats" role="region" aria-label="打字統計">
                <div class="stat-item">
                    <span class="stat-value" id="wpm" aria-label="每分鐘字數">0</span>
                    <span>WPM</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="accuracy" aria-label="準確率">100%</span>
                    <span>準確率</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="progress" aria-label="練習進度">0/10</span>
                    <span>進度</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="count" aria-label="顯示句子數量">100</span>
                    <span>句子</span>
                </div>
            </div>
        </nav>

        <main class="practice-area" role="main">
            <section class="sentence-display" aria-label="練習句子">
                <div class="sentence" id="target-sentence" role="text" aria-label="目標句子" aria-live="polite"></div>
                <div class="audio-controls" role="group" aria-label="語音控制">
                    <button class="audio-btn" id="play-sentence" aria-label="播放完整句子" aria-describedby="play-sentence-desc">
                        🔊 播放句子
                    </button>
                    <div id="play-sentence-desc" class="sr-only">點擊播放當前英文句子的完整發音</div>
                    <button class="audio-btn" id="play-slow" aria-label="慢速播放句子" aria-describedby="play-slow-desc">
                        🐌 慢速播放
                    </button>
                    <div id="play-slow-desc" class="sr-only">點擊以較慢語速播放當前英文句子</div>
                </div>
                <div class="translation" id="translation" aria-label="中文翻譯" aria-live="polite"></div>
            </section>

            <div class="progress-bar" role="progressbar" aria-label="打字進度">
                <div class="progress-fill" id="progress-fill"></div>
            </div>

            <div class="input-area">
                <label for="typing-input" class="sr-only">請在此輸入上方英文句子</label>
                <textarea 
                    class="typing-input" 
                    id="typing-input" 
                    placeholder="在此輸入上方英文句子..."
                    rows="3"
                    aria-describedby="feedback"
                    spellcheck="false"
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="off"
                ></textarea>
            </div>

            <div class="feedback" id="feedback" role="status" aria-live="polite"></div>

            <button class="next-btn" id="next-btn" disabled aria-label="進入下一句練習">下一句 →</button>

            <section class="vocabulary" id="vocabulary" style="display: none;" aria-label="重點單字">
                <div class="vocab-title">📚 重點單字與片語</div>
                <div id="vocab-content"></div>
            </section>
        </main>


        <footer class="footer">
            <p>&copy; 2025 English Typing Practice. 英文打字練習工具 - 免費線上英語打字訓練</p>
            <p>適合學生、上班族、英語學習者使用 | <a href="mailto:contact@example.com">聯絡我們</a></p>
        </footer>
    </div>

    <script>
        class TypingPractice {
            constructor() {
                this.currentLevel = 'B2';
                this.currentSentenceIndex = 0;
                this.currentCharIndex = 0;
                this.startTime = null;
                this.errors = 0;
                this.totalChars = 0;
                this.completed = 0;
                this.speechRate = 1.0;
                this.currentSpeech = null;
                this.filteredSentences = [];
                this.levelFilter = 'B2';
                this.contextFilter = 'all';
                this.hideChinese = false;
                this.hideEnglish = false;
                
                // Cache DOM elements for better performance
                this.elements = {};
                
                // Performance monitoring
                this.performanceMetrics = {
                    typingStartTime: null,
                    totalTypingTime: 0,
                    keystrokes: 0,
                    errors: 0
                };
                
                // Debounce utility
                this.debounce = (func, wait) => {
                    let timeout;
                    return function executedFunction(...args) {
                        const later = () => {
                            clearTimeout(timeout);
                            func(...args);
                        };
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                    };
                };
                
                this.sentences = {
                    A2: [
                        // A2 級別 (10句)
                        { level: 'A2', context: '日常對話', text: 'I usually wake up at seven in the morning.', keywords: ['usually', 'wake up'], translation: '我通常早上七點起床。', vocabulary: [{ word: 'usually', meaning: '通常' }, { word: 'wake up', meaning: '起床' }] },
                        { level: 'A2', context: '旅遊', text: 'Could you recommend a good restaurant nearby?', keywords: ['recommend', 'restaurant', 'nearby'], translation: '你能推薦附近的好餐廳嗎？', vocabulary: [{ word: 'recommend', meaning: '推薦' }, { word: 'restaurant', meaning: '餐廳' }, { word: 'nearby', meaning: '附近' }] },
                        { level: 'A2', context: '日常對話', text: 'She is learning to play the guitar.', keywords: ['learning', 'play', 'guitar'], translation: '她正在學習彈吉他。', vocabulary: [{ word: 'learning', meaning: '學習' }, { word: 'play', meaning: '彈奏' }, { word: 'guitar', meaning: '吉他' }] },
                        { level: 'A2', context: '商務', text: 'I need to finish this report by Friday.', keywords: ['need', 'finish', 'report'], translation: '我需要在週五前完成這份報告。', vocabulary: [{ word: 'need', meaning: '需要' }, { word: 'finish', meaning: '完成' }, { word: 'report', meaning: '報告' }] },
                        { level: 'A2', context: '日常對話', text: 'We went shopping last weekend.', keywords: ['went', 'shopping', 'weekend'], translation: '我們上週末去購物了。', vocabulary: [{ word: 'went', meaning: '去' }, { word: 'shopping', meaning: '購物' }, { word: 'weekend', meaning: '週末' }] },
                        { level: 'A2', context: '旅遊', text: 'The hotel room was clean and comfortable.', keywords: ['hotel', 'clean', 'comfortable'], translation: '酒店房間很乾淨舒適。', vocabulary: [{ word: 'hotel', meaning: '酒店' }, { word: 'clean', meaning: '乾淨' }, { word: 'comfortable', meaning: '舒適' }] },
                        { level: 'A2', context: '日常對話', text: 'My brother works at a bank.', keywords: ['brother', 'works', 'bank'], translation: '我哥哥在銀行工作。', vocabulary: [{ word: 'brother', meaning: '哥哥' }, { word: 'works', meaning: '工作' }, { word: 'bank', meaning: '銀行' }] },
                        { level: 'A2', context: '日常對話', text: 'They are planning a trip to Japan.', keywords: ['planning', 'trip'], translation: '他們正在計劃去日本旅行。', vocabulary: [{ word: 'planning', meaning: '計劃' }, { word: 'trip', meaning: '旅行' }] },
                        { level: 'A2', context: '日常對話', text: 'I enjoy reading books in my free time.', keywords: ['enjoy', 'reading', 'free time'], translation: '我喜歡在空閒時間讀書。', vocabulary: [{ word: 'enjoy', meaning: '喜歡' }, { word: 'reading', meaning: '閱讀' }, { word: 'free time', meaning: '空閒時間' }] },
                        { level: 'A2', context: '旅遊', text: 'What time does the train leave?', keywords: ['what time', 'train', 'leave'], translation: '火車什麼時候開？', vocabulary: [{ word: 'what time', meaning: '什麼時候' }, { word: 'train', meaning: '火車' }, { word: 'leave', meaning: '離開' }] },
                        
                        // 文法練習 - A2 級別 (5句)
                        { level: 'A2', context: '文法', text: 'I have been studying English for three years.', keywords: ['present perfect continuous', 'for'], translation: '我已經學英語三年了。', vocabulary: [{ word: 'present perfect continuous', meaning: '現在完成進行式' }, { word: 'for', meaning: '持續時間' }] },
                        { level: 'A2', context: '文法', text: 'She is taller than her brother.', keywords: ['comparative', 'than'], translation: '她比她哥哥高。', vocabulary: [{ word: 'comparative', meaning: '比較級' }, { word: 'than', meaning: '比' }] },
                        { level: 'A2', context: '文法', text: 'If it rains tomorrow, we will stay home.', keywords: ['first conditional', 'if', 'will'], translation: '如果明天下雨，我們就待在家裡。', vocabulary: [{ word: 'first conditional', meaning: '第一條件句' }, { word: 'if', meaning: '如果' }, { word: 'will', meaning: '將會' }] },
                        { level: 'A2', context: '文法', text: 'The book was written by a famous author.', keywords: ['passive voice', 'was written', 'by'], translation: '這本書是由一位著名作家寫的。', vocabulary: [{ word: 'passive voice', meaning: '被動語態' }, { word: 'was written', meaning: '被寫' }, { word: 'by', meaning: '由' }] },
                        { level: 'A2', context: '文法', text: 'I am going to visit my grandparents next week.', keywords: ['be going to', 'future plan'], translation: '我下週要去看我的祖父母。', vocabulary: [{ word: 'be going to', meaning: '將要' }, { word: 'future plan', meaning: '未來計劃' }] },
                        
                        // 片語練習 - A2 級別 (5句)
                        { level: 'A2', context: '片語', text: 'Can you look after my dog while I am away?', keywords: ['look after', 'take care of'], translation: '我不在的時候你能照顧我的狗嗎？', vocabulary: [{ word: 'look after', meaning: '照顧' }, { word: 'take care of', meaning: '照顧' }] },
                        { level: 'A2', context: '片語', text: 'I need to find out what time the train leaves.', keywords: ['find out', 'discover'], translation: '我需要查清楚火車什麼時候開。', vocabulary: [{ word: 'find out', meaning: '查清楚' }, { word: 'discover', meaning: '發現' }] },
                        { level: 'A2', context: '片語', text: 'Please turn off the lights before you leave.', keywords: ['turn off', 'switch off'], translation: '離開前請關燈。', vocabulary: [{ word: 'turn off', meaning: '關掉' }, { word: 'switch off', meaning: '關掉' }] },
                        { level: 'A2', context: '片語', text: 'She came across an old friend at the supermarket.', keywords: ['come across', 'meet by chance'], translation: '她在超市偶然遇到了一位老朋友。', vocabulary: [{ word: 'come across', meaning: '偶然遇到' }, { word: 'meet by chance', meaning: '偶然遇到' }] },
                        { level: 'A2', context: '片語', text: 'We need to put off the meeting until next week.', keywords: ['put off', 'postpone'], translation: '我們需要把會議推遲到下週。', vocabulary: [{ word: 'put off', meaning: '推遲' }, { word: 'postpone', meaning: '推遲' }] }
                    ],
                    B1: [
                        // B1 級別 (10句)
                        { level: 'B1', context: '學術', text: 'Environmental protection has become a global priority.', keywords: ['environmental', 'protection', 'global', 'priority'], translation: '環境保護已成為全球優先事項。', vocabulary: [{ word: 'environmental', meaning: '環境的' }, { word: 'protection', meaning: '保護' }, { word: 'global', meaning: '全球的' }, { word: 'priority', meaning: '優先事項' }] },
                        { level: 'B1', context: '商務', text: 'Our company is expanding into new markets this year.', keywords: ['company', 'expanding', 'markets'], translation: '我們公司今年正在擴展到新市場。', vocabulary: [{ word: 'company', meaning: '公司' }, { word: 'expanding', meaning: '擴展' }, { word: 'markets', meaning: '市場' }] },
                        { level: 'B1', context: '日常對話', text: 'Although it was raining, we decided to go hiking.', keywords: ['although', 'decided', 'hiking'], translation: '雖然下雨了，我們還是決定去遠足。', vocabulary: [{ word: 'although', meaning: '雖然' }, { word: 'decided', meaning: '決定' }, { word: 'hiking', meaning: '遠足' }] },
                        { level: 'B1', context: '科技', text: 'Social media has changed the way we communicate.', keywords: ['social media', 'communicate'], translation: '社交媒體改變了我們的溝通方式。', vocabulary: [{ word: 'social media', meaning: '社交媒體' }, { word: 'communicate', meaning: '溝通' }] },
                        { level: 'B1', context: '學術', text: 'The research suggests that exercise improves mental health.', keywords: ['research', 'suggests', 'exercise', 'mental health'], translation: '研究顯示運動能改善心理健康。', vocabulary: [{ word: 'research', meaning: '研究' }, { word: 'suggests', meaning: '顯示' }, { word: 'exercise', meaning: '運動' }, { word: 'mental health', meaning: '心理健康' }] },
                        { level: 'B1', context: '商務', text: 'We should schedule a meeting to discuss the project.', keywords: ['schedule', 'meeting', 'discuss'], translation: '我們應該安排一個會議來討論這個項目。', vocabulary: [{ word: 'schedule', meaning: '安排' }, { word: 'meeting', meaning: '會議' }, { word: 'discuss', meaning: '討論' }] },
                        { level: 'B1', context: '日常對話', text: 'If I had more time, I would learn a new language.', keywords: ['if', 'had', 'would learn'], translation: '如果我有更多時間，我會學一門新語言。', vocabulary: [{ word: 'if', meaning: '如果' }, { word: 'had', meaning: '有' }, { word: 'would learn', meaning: '會學習' }] },
                        { level: 'B1', context: '旅遊', text: 'Traveling abroad broadens your perspective on life.', keywords: ['traveling', 'broadens', 'perspective'], translation: '出國旅行能拓寬你對生活的視角。', vocabulary: [{ word: 'traveling', meaning: '旅行' }, { word: 'broadens', meaning: '拓寬' }, { word: 'perspective', meaning: '視角' }] },
                        { level: 'B1', context: '學術', text: 'Students are encouraged to participate in class discussions.', keywords: ['encouraged', 'participate', 'discussions'], translation: '鼓勵學生參與課堂討論。', vocabulary: [{ word: 'encouraged', meaning: '鼓勵' }, { word: 'participate', meaning: '參與' }, { word: 'discussions', meaning: '討論' }] },
                        { level: 'B1', context: '日常對話', text: 'I am considering moving to a bigger apartment.', keywords: ['considering', 'moving', 'apartment'], translation: '我正在考慮搬到更大的公寓。', vocabulary: [{ word: 'considering', meaning: '考慮' }, { word: 'moving', meaning: '搬家' }, { word: 'apartment', meaning: '公寓' }] },
                        
                        // 文法練習 - B1 級別 (5句)
                        { level: 'B1', context: '文法', text: 'I wish I could speak French fluently.', keywords: ['wish', 'could', 'unreal present'], translation: '我希望我能流利地說法語。', vocabulary: [{ word: 'wish', meaning: '希望' }, { word: 'could', meaning: '能夠' }, { word: 'unreal present', meaning: '非真實現在' }] },
                        { level: 'B1', context: '文法', text: 'Having finished my homework, I went out to play.', keywords: ['perfect participle', 'having finished'], translation: '完成作業後，我出去玩了。', vocabulary: [{ word: 'perfect participle', meaning: '完成分詞' }, { word: 'having finished', meaning: '完成後' }] },
                        { level: 'B1', context: '文法', text: 'She made me feel comfortable during the interview.', keywords: ['causative', 'made', 'feel'], translation: '她在面試期間讓我感到舒適。', vocabulary: [{ word: 'causative', meaning: '使役動詞' }, { word: 'made', meaning: '使' }, { word: 'feel', meaning: '感到' }] },
                        { level: 'B1', context: '文法', text: 'I would have passed the exam if I had studied harder.', keywords: ['third conditional', 'would have', 'had studied'], translation: '如果我更努力學習，我就會通過考試。', vocabulary: [{ word: 'third conditional', meaning: '第三條件句' }, { word: 'would have', meaning: '會已經' }, { word: 'had studied', meaning: '已經學習' }] },
                        { level: 'B1', context: '文法', text: 'The manager suggested that we postpone the meeting.', keywords: ['subjunctive', 'suggested', 'postpone'], translation: '經理建議我們推遲會議。', vocabulary: [{ word: 'subjunctive', meaning: '虛擬語氣' }, { word: 'suggested', meaning: '建議' }, { word: 'postpone', meaning: '推遲' }] },
                        
                        // 片語練習 - B1 級別 (5句)
                        { level: 'B1', context: '片語', text: 'The company is looking into new investment opportunities.', keywords: ['look into', 'investigate'], translation: '公司正在調查新的投資機會。', vocabulary: [{ word: 'look into', meaning: '調查' }, { word: 'investigate', meaning: '調查' }] },
                        { level: 'B1', context: '片語', text: 'I cannot put up with this noise any longer.', keywords: ['put up with', 'tolerate'], translation: '我再也無法忍受這種噪音了。', vocabulary: [{ word: 'put up with', meaning: '忍受' }, { word: 'tolerate', meaning: '容忍' }] },
                        { level: 'B1', context: '片語', text: 'The project fell through due to lack of funding.', keywords: ['fall through', 'fail'], translation: '由於缺乏資金，這個項目失敗了。', vocabulary: [{ word: 'fall through', meaning: '失敗' }, { word: 'fail', meaning: '失敗' }] },
                        { level: 'B1', context: '片語', text: 'She gets along well with her colleagues.', keywords: ['get along with', 'have good relationship'], translation: '她與同事相處得很好。', vocabulary: [{ word: 'get along with', meaning: '相處' }, { word: 'have good relationship', meaning: '有好關係' }] },
                        { level: 'B1', context: '片語', text: 'We ran out of time before finishing the presentation.', keywords: ['run out of', 'exhaust'], translation: '我們在完成簡報前時間用完了。', vocabulary: [{ word: 'run out of', meaning: '用完' }, { word: 'exhaust', meaning: '耗盡' }] },
                        
                        // 原有B1句子
                        {
                            text: "The weather forecast suggests that tomorrow will be significantly warmer than today.",
                            translation: "天氣預報顯示明天會比今天暖和得多。",
                            vocabulary: [
                                { word: "forecast", meaning: "預報" },
                                { word: "significantly", meaning: "顯著地" }
                            ]
                        },
                        {
                            text: "She decided to pursue a career in environmental science after watching a documentary.",
                            translation: "在看了一部紀錄片後，她決定從事環境科學的職業。",
                            vocabulary: [
                                { word: "pursue", meaning: "追求，從事" },
                                { word: "environmental", meaning: "環境的" },
                                { word: "documentary", meaning: "紀錄片" }
                            ]
                        },
                        {
                            text: "The restaurant manager apologized for the inconvenience caused by the delayed service.",
                            translation: "餐廳經理為延誤服務造成的不便道歉。",
                            vocabulary: [
                                { word: "apologized", meaning: "道歉" },
                                { word: "inconvenience", meaning: "不便" },
                                { word: "delayed", meaning: "延誤的" }
                            ]
                        },
                        {
                            text: "Regular exercise and a balanced diet are essential for maintaining good health.",
                            translation: "規律運動和均衡飲食對於維持良好健康是必不可少的。",
                            vocabulary: [
                                { word: "balanced", meaning: "均衡的" },
                                { word: "essential", meaning: "必不可少的" },
                                { word: "maintaining", meaning: "維持" }
                            ]
                        },
                        {
                            text: "The conference will focus on innovative solutions to address climate change challenges.",
                            translation: "這次會議將專注於應對氣候變化挑戰的創新解決方案。",
                            vocabulary: [
                                { word: "conference", meaning: "會議" },
                                { word: "innovative", meaning: "創新的" },
                                { word: "address", meaning: "應對，處理" }
                            ]
                        },
                        {
                            text: "Online learning platforms have become increasingly popular among students worldwide.",
                            translation: "線上學習平台在全世界的學生中越來越受歡迎。",
                            vocabulary: [
                                { word: "platforms", meaning: "平台" },
                                { word: "increasingly", meaning: "越來越" },
                                { word: "popular", meaning: "受歡迎的" }
                            ]
                        },
                        {
                            text: "The company implemented new security measures to protect customer information.",
                            translation: "公司實施了新的安全措施來保護客戶信息。",
                            vocabulary: [
                                { word: "implemented", meaning: "實施" },
                                { word: "measures", meaning: "措施" },
                                { word: "protect", meaning: "保護" }
                            ]
                        },
                        {
                            text: "Cultural diversity enriches our understanding of different perspectives and traditions.",
                            translation: "文化多樣性豐富了我們對不同觀點和傳統的理解。",
                            vocabulary: [
                                { word: "diversity", meaning: "多樣性" },
                                { word: "enriches", meaning: "豐富" },
                                { word: "perspectives", meaning: "觀點" }
                            ]
                        },
                        {
                            text: "Scientists continue to explore renewable energy sources as alternatives to fossil fuels.",
                            translation: "科學家們繼續探索可再生能源作為化石燃料的替代品。",
                            vocabulary: [
                                { word: "renewable", meaning: "可再生的" },
                                { word: "sources", meaning: "來源" },
                                { word: "alternatives", meaning: "替代品" }
                            ]
                        },
                        {
                            text: "The museum exhibition displays artifacts from ancient civilizations around the world.",
                            translation: "博物館展覽展示了來自世界各地古代文明的文物。",
                            vocabulary: [
                                { word: "exhibition", meaning: "展覽" },
                                { word: "artifacts", meaning: "文物" },
                                { word: "civilizations", meaning: "文明" }
                            ]
                        }
                    ],
                    B2: [
                        // B2 級別 (15句)
                        { level: 'B2', context: '學術', text: 'The study demonstrates a significant correlation between diet and longevity.', keywords: ['demonstrates', 'correlation', 'longevity'], translation: '這項研究顯示飲食與長壽之間存在顯著相關性。', vocabulary: [{ word: 'demonstrates', meaning: '顯示' }, { word: 'correlation', meaning: '相關性' }, { word: 'longevity', meaning: '長壽' }] },
                        { level: 'B2', context: '商務', text: 'Implementing effective strategies requires thorough market analysis.', keywords: ['implementing', 'strategies', 'thorough', 'analysis'], translation: '實施有效策略需要徹底的市場分析。', vocabulary: [{ word: 'implementing', meaning: '實施' }, { word: 'strategies', meaning: '策略' }, { word: 'thorough', meaning: '徹底的' }, { word: 'analysis', meaning: '分析' }] },
                        { level: 'B2', context: '科技', text: 'Artificial intelligence is revolutionizing various industries worldwide.', keywords: ['artificial intelligence', 'revolutionizing', 'industries'], translation: '人工智能正在徹底改變世界各地的各種行業。', vocabulary: [{ word: 'artificial intelligence', meaning: '人工智能' }, { word: 'revolutionizing', meaning: '徹底改變' }, { word: 'industries', meaning: '行業' }] },
                        { level: 'B2', context: '學術', text: 'Critics argue that the methodology used was fundamentally flawed.', keywords: ['critics', 'methodology', 'fundamentally', 'flawed'], translation: '批評者認為所使用的方法論存在根本性缺陷。', vocabulary: [{ word: 'critics', meaning: '批評者' }, { word: 'methodology', meaning: '方法論' }, { word: 'fundamentally', meaning: '根本地' }, { word: 'flawed', meaning: '有缺陷的' }] },
                        { level: 'B2', context: '商務', text: 'The merger will potentially enhance our competitive advantage.', keywords: ['merger', 'potentially', 'enhance', 'competitive advantage'], translation: '這次合併可能會增強我們的競爭優勢。', vocabulary: [{ word: 'merger', meaning: '合併' }, { word: 'potentially', meaning: '可能' }, { word: 'enhance', meaning: '增強' }, { word: 'competitive advantage', meaning: '競爭優勢' }] },
                        { level: 'B2', context: '日常對話', text: 'Despite numerous setbacks, she persevered and achieved her goals.', keywords: ['despite', 'setbacks', 'persevered', 'achieved'], translation: '儘管遇到許多挫折，她堅持不懈並實現了目標。', vocabulary: [{ word: 'despite', meaning: '儘管' }, { word: 'setbacks', meaning: '挫折' }, { word: 'persevered', meaning: '堅持不懈' }, { word: 'achieved', meaning: '實現' }] },
                        { level: 'B2', context: '學術', text: 'The findings contradict previous assumptions about climate change.', keywords: ['findings', 'contradict', 'assumptions'], translation: '這些發現與之前關於氣候變化的假設相矛盾。', vocabulary: [{ word: 'findings', meaning: '發現' }, { word: 'contradict', meaning: '矛盾' }, { word: 'assumptions', meaning: '假設' }] },
                        { level: 'B2', context: '科技', text: 'Cybersecurity has become increasingly crucial in the digital age.', keywords: ['cybersecurity', 'increasingly', 'crucial', 'digital age'], translation: '在數位時代，網路安全變得越來越重要。', vocabulary: [{ word: 'cybersecurity', meaning: '網路安全' }, { word: 'increasingly', meaning: '越來越' }, { word: 'crucial', meaning: '重要的' }, { word: 'digital age', meaning: '數位時代' }] },
                        { level: 'B2', context: '商務', text: 'We must allocate resources more efficiently to maximize profits.', keywords: ['allocate', 'efficiently', 'maximize', 'profits'], translation: '我們必須更有效地分配資源以最大化利潤。', vocabulary: [{ word: 'allocate', meaning: '分配' }, { word: 'efficiently', meaning: '有效地' }, { word: 'maximize', meaning: '最大化' }, { word: 'profits', meaning: '利潤' }] },
                        { level: 'B2', context: '日常對話', text: 'Her dedication to excellence is truly admirable and inspiring.', keywords: ['dedication', 'excellence', 'admirable', 'inspiring'], translation: '她對卓越的奉獻精神真正令人欽佩和鼓舞人心。', vocabulary: [{ word: 'dedication', meaning: '奉獻' }, { word: 'excellence', meaning: '卓越' }, { word: 'admirable', meaning: '令人欽佩的' }, { word: 'inspiring', meaning: '鼓舞人心的' }] },
                        { level: 'B2', context: '學術', text: 'The hypothesis provides compelling evidence for evolutionary adaptation.', keywords: ['hypothesis', 'compelling', 'evolutionary', 'adaptation'], translation: '這個假說為進化適應提供了令人信服的證據。', vocabulary: [{ word: 'hypothesis', meaning: '假說' }, { word: 'compelling', meaning: '令人信服的' }, { word: 'evolutionary', meaning: '進化的' }, { word: 'adaptation', meaning: '適應' }] },
                        { level: 'B2', context: '商務', text: 'Sustainable practices are essential for long-term corporate success.', keywords: ['sustainable', 'practices', 'essential', 'corporate'], translation: '可持續實踐對長期企業成功至關重要。', vocabulary: [{ word: 'sustainable', meaning: '可持續的' }, { word: 'practices', meaning: '實踐' }, { word: 'essential', meaning: '至關重要的' }, { word: 'corporate', meaning: '企業的' }] },
                        { level: 'B2', context: '科技', text: 'Data privacy concerns have prompted stricter regulations globally.', keywords: ['data privacy', 'concerns', 'prompted', 'regulations'], translation: '數據隱私擔憂促使全球制定更嚴格的法規。', vocabulary: [{ word: 'data privacy', meaning: '數據隱私' }, { word: 'concerns', meaning: '擔憂' }, { word: 'prompted', meaning: '促使' }, { word: 'regulations', meaning: '法規' }] },
                        { level: 'B2', context: '學術', text: 'The phenomenon exhibits characteristics consistent with previous research.', keywords: ['phenomenon', 'exhibits', 'characteristics', 'consistent'], translation: '這個現象表現出與先前研究一致的特徵。', vocabulary: [{ word: 'phenomenon', meaning: '現象' }, { word: 'exhibits', meaning: '表現' }, { word: 'characteristics', meaning: '特徵' }, { word: 'consistent', meaning: '一致的' }] },
                        { level: 'B2', context: '商務', text: 'Transparent communication fosters trust among team members.', keywords: ['transparent', 'communication', 'fosters', 'trust'], translation: '透明的溝通促進團隊成員之間的信任。', vocabulary: [{ word: 'transparent', meaning: '透明的' }, { word: 'communication', meaning: '溝通' }, { word: 'fosters', meaning: '促進' }, { word: 'trust', meaning: '信任' }] },
                        
                        // 文法練習 - B2 級別 (5句)
                        { level: 'B2', context: '文法', text: 'No sooner had I arrived than the meeting started.', keywords: ['inversion', 'no sooner', 'than'], translation: '我一到會議就開始了。', vocabulary: [{ word: 'inversion', meaning: '倒裝' }, { word: 'no sooner', meaning: '一...就' }, { word: 'than', meaning: '比' }] },
                        { level: 'B2', context: '文法', text: 'Were I in your position, I would accept the offer.', keywords: ['inversion', 'were', 'conditional'], translation: '如果我是你，我會接受這個提議。', vocabulary: [{ word: 'inversion', meaning: '倒裝' }, { word: 'were', meaning: '是' }, { word: 'conditional', meaning: '條件句' }] },
                        { level: 'B2', context: '文法', text: 'The committee, which had been deliberating for hours, finally reached a decision.', keywords: ['non-defining relative clause', 'which'], translation: '委員會經過數小時的審議，最終做出了決定。', vocabulary: [{ word: 'non-defining relative clause', meaning: '非限定性關係子句' }, { word: 'which', meaning: '哪個' }] },
                        { level: 'B2', context: '文法', text: 'Not only did she complete the project, but she also exceeded expectations.', keywords: ['inversion', 'not only', 'but also'], translation: '她不僅完成了項目，還超出了預期。', vocabulary: [{ word: 'inversion', meaning: '倒裝' }, { word: 'not only', meaning: '不僅' }, { word: 'but also', meaning: '而且' }] },
                        { level: 'B2', context: '文法', text: 'It is imperative that students submit their assignments on time.', keywords: ['subjunctive', 'imperative', 'submit'], translation: '學生必須按時提交作業。', vocabulary: [{ word: 'subjunctive', meaning: '虛擬語氣' }, { word: 'imperative', meaning: '必須的' }, { word: 'submit', meaning: '提交' }] },
                        
                        // 片語練習 - B2 級別 (5句)
                        { level: 'B2', context: '片語', text: 'The manager cracked down on employees who arrived late.', keywords: ['crack down on', 'take strict measures'], translation: '經理對遲到的員工採取了嚴厲措施。', vocabulary: [{ word: 'crack down on', meaning: '嚴厲打擊' }, { word: 'take strict measures', meaning: '採取嚴厲措施' }] },
                        { level: 'B2', context: '片語', text: 'The negotiations broke down after several hours of discussion.', keywords: ['break down', 'fail'], translation: '經過數小時討論後，談判破裂了。', vocabulary: [{ word: 'break down', meaning: '破裂' }, { word: 'fail', meaning: '失敗' }] },
                        { level: 'B2', context: '片語', text: 'We need to iron out the details before signing the contract.', keywords: ['iron out', 'resolve problems'], translation: '我們需要在簽約前解決細節問題。', vocabulary: [{ word: 'iron out', meaning: '解決' }, { word: 'resolve problems', meaning: '解決問題' }] },
                        { level: 'B2', context: '片語', text: 'The new policy has done away with many bureaucratic procedures.', keywords: ['do away with', 'eliminate'], translation: '新政策廢除了許多官僚程序。', vocabulary: [{ word: 'do away with', meaning: '廢除' }, { word: 'eliminate', meaning: '消除' }] },
                        { level: 'B2', context: '片語', text: 'She finally came to terms with the loss of her job.', keywords: ['come to terms with', 'accept'], translation: '她終於接受了失去工作的事實。', vocabulary: [{ word: 'come to terms with', meaning: '接受' }, { word: 'accept', meaning: '接受' }] },
                        
                        // 原有B2句子
                        {
                            text: "The implementation of artificial intelligence in healthcare has revolutionized diagnostic procedures.",
                            translation: "人工智能在醫療保健領域的實施已經徹底改變了診斷程序。",
                            vocabulary: [
                                { word: "implementation", meaning: "實施" },
                                { word: "revolutionized", meaning: "徹底改變" },
                                { word: "diagnostic", meaning: "診斷的" }
                            ]
                        },
                        {
                            text: "Despite the challenging circumstances, the team demonstrated remarkable resilience and adaptability.",
                            translation: "儘管環境充滿挑戰，團隊展現了非凡的韌性和適應能力。",
                            vocabulary: [
                                { word: "circumstances", meaning: "環境，情況" },
                                { word: "remarkable", meaning: "非凡的" },
                                { word: "resilience", meaning: "韌性" },
                                { word: "adaptability", meaning: "適應能力" }
                            ]
                        },
                        {
                            text: "The sustainable development goals require collaborative efforts from governments and corporations worldwide.",
                            translation: "可持續發展目標需要全球政府和企業的合作努力。",
                            vocabulary: [
                                { word: "sustainable", meaning: "可持續的" },
                                { word: "collaborative", meaning: "合作的" },
                                { word: "corporations", meaning: "企業" }
                            ]
                        },
                        {
                            text: "Contemporary literature often explores themes of identity, belonging, and social transformation.",
                            translation: "當代文學經常探索身份認同、歸屬感和社會變革的主題。",
                            vocabulary: [
                                { word: "contemporary", meaning: "當代的" },
                                { word: "explores", meaning: "探索" },
                                { word: "transformation", meaning: "變革" }
                            ]
                        },
                        {
                            text: "The psychological impact of social media on adolescents has become a significant research focus.",
                            translation: "社交媒體對青少年心理影響已成為重要研究焦點。",
                            vocabulary: [
                                { word: "psychological", meaning: "心理的" },
                                { word: "adolescents", meaning: "青少年" },
                                { word: "significant", meaning: "重要的" }
                            ]
                        },
                        {
                            text: "Economic fluctuations demonstrate the interconnected nature of global financial markets.",
                            translation: "經濟波動顯示了全球金融市場的相互關聯性。",
                            vocabulary: [
                                { word: "fluctuations", meaning: "波動" },
                                { word: "interconnected", meaning: "相互關聯的" },
                                { word: "financial", meaning: "金融的" }
                            ]
                        },
                        {
                            text: "Technological advancements have fundamentally altered communication patterns across different generations.",
                            translation: "技術進步根本改變了不同世代之間的溝通模式。",
                            vocabulary: [
                                { word: "advancements", meaning: "進步" },
                                { word: "fundamentally", meaning: "根本地" },
                                { word: "generations", meaning: "世代" }
                            ]
                        },
                        {
                            text: "Archaeological discoveries continue to challenge our assumptions about ancient civilizations.",
                            translation: "考古發現持續挑戰我們對古代文明的假設。",
                            vocabulary: [
                                { word: "archaeological", meaning: "考古的" },
                                { word: "challenge", meaning: "挑戰" },
                                { word: "assumptions", meaning: "假設" }
                            ]
                        },
                        {
                            text: "The complexity of urban planning requires interdisciplinary collaboration among various stakeholders.",
                            translation: "城市規劃的複雜性需要各利益相關者之間的跨學科合作。",
                            vocabulary: [
                                { word: "complexity", meaning: "複雜性" },
                                { word: "interdisciplinary", meaning: "跨學科的" },
                                { word: "stakeholders", meaning: "利益相關者" }
                            ]
                        },
                        {
                            text: "Environmental conservation efforts must balance ecological protection with economic development needs.",
                            translation: "環境保護努力必須平衡生態保護與經濟發展需求。",
                            vocabulary: [
                                { word: "conservation", meaning: "保護" },
                                { word: "ecological", meaning: "生態的" },
                                { word: "development", meaning: "發展" }
                            ]
                        }
                    ],
                    C1: [
                        // C1 級別 (15句)
                        { level: 'C1', context: '學術', text: 'The ramifications of this paradigm shift will undoubtedly reshape contemporary discourse.', keywords: ['ramifications', 'paradigm shift', 'contemporary', 'discourse'], translation: '這種範式轉變的影響無疑將重塑當代話語。', vocabulary: [{ word: 'ramifications', meaning: '影響' }, { word: 'paradigm shift', meaning: '範式轉變' }, { word: 'contemporary', meaning: '當代的' }, { word: 'discourse', meaning: '話語' }] },
                        { level: 'C1', context: '商務', text: 'Stakeholders must scrutinize the viability of this unprecedented initiative.', keywords: ['stakeholders', 'scrutinize', 'viability', 'unprecedented'], translation: '利益相關者必須仔細審視這項前所未有的倡議的可行性。', vocabulary: [{ word: 'stakeholders', meaning: '利益相關者' }, { word: 'scrutinize', meaning: '仔細審視' }, { word: 'viability', meaning: '可行性' }, { word: 'unprecedented', meaning: '前所未有的' }] },
                        { level: 'C1', context: '學術', text: 'The hypothesis posits an intricate relationship between cognitive processes and neuroplasticity.', keywords: ['hypothesis', 'posits', 'intricate', 'neuroplasticity'], translation: '這個假說提出了認知過程與神經可塑性之間複雜的關係。', vocabulary: [{ word: 'hypothesis', meaning: '假說' }, { word: 'posits', meaning: '提出' }, { word: 'intricate', meaning: '複雜的' }, { word: 'neuroplasticity', meaning: '神經可塑性' }] },
                        { level: 'C1', context: '科技', text: 'Quantum computing represents a monumental leap in computational capabilities.', keywords: ['quantum computing', 'monumental', 'computational'], translation: '量子計算代表了計算能力的巨大飛躍。', vocabulary: [{ word: 'quantum computing', meaning: '量子計算' }, { word: 'monumental', meaning: '巨大的' }, { word: 'computational', meaning: '計算的' }] },
                        { level: 'C1', context: '學術', text: 'The dissertation meticulously examines the epistemological foundations of modern philosophy.', keywords: ['dissertation', 'meticulously', 'epistemological', 'foundations'], translation: '這篇論文細緻地檢視了現代哲學的認識論基礎。', vocabulary: [{ word: 'dissertation', meaning: '論文' }, { word: 'meticulously', meaning: '細緻地' }, { word: 'epistemological', meaning: '認識論的' }, { word: 'foundations', meaning: '基礎' }] },
                        { level: 'C1', context: '商務', text: 'Regulatory compliance necessitates comprehensive oversight and stringent protocols.', keywords: ['regulatory', 'compliance', 'oversight', 'stringent', 'protocols'], translation: '監管合規需要全面的監督和嚴格的協議。', vocabulary: [{ word: 'regulatory', meaning: '監管的' }, { word: 'compliance', meaning: '合規' }, { word: 'oversight', meaning: '監督' }, { word: 'stringent', meaning: '嚴格的' }, { word: 'protocols', meaning: '協議' }] },
                        { level: 'C1', context: '學術', text: 'Scholars have endeavored to elucidate the ambiguities inherent in classical literature.', keywords: ['scholars', 'elucidate', 'ambiguities', 'inherent'], translation: '學者們努力闡明古典文學中固有的模糊性。', vocabulary: [{ word: 'scholars', meaning: '學者' }, { word: 'elucidate', meaning: '闡明' }, { word: 'ambiguities', meaning: '模糊性' }, { word: 'inherent', meaning: '固有的' }] },
                        { level: 'C1', context: '科技', text: 'The proliferation of misinformation undermines the integrity of digital platforms.', keywords: ['proliferation', 'misinformation', 'undermines', 'integrity'], translation: '錯誤信息的擴散破壞了數位平台的完整性。', vocabulary: [{ word: 'proliferation', meaning: '擴散' }, { word: 'misinformation', meaning: '錯誤信息' }, { word: 'undermines', meaning: '破壞' }, { word: 'integrity', meaning: '完整性' }] },
                        { level: 'C1', context: '商務', text: 'Diversification remains paramount for mitigating inherent financial risks.', keywords: ['diversification', 'paramount', 'mitigating', 'inherent'], translation: '多元化對於減輕固有財務風險仍然至關重要。', vocabulary: [{ word: 'diversification', meaning: '多元化' }, { word: 'paramount', meaning: '至關重要的' }, { word: 'mitigating', meaning: '減輕' }, { word: 'inherent', meaning: '固有的' }] },
                        { level: 'C1', context: '學術', text: 'The nuanced interplay between socioeconomic factors warrants further investigation.', keywords: ['nuanced', 'interplay', 'socioeconomic', 'warrants'], translation: '社會經濟因素之間細微的相互作用值得進一步調查。', vocabulary: [{ word: 'nuanced', meaning: '細微的' }, { word: 'interplay', meaning: '相互作用' }, { word: 'socioeconomic', meaning: '社會經濟的' }, { word: 'warrants', meaning: '值得' }] },
                        { level: 'C1', context: '學術', text: 'The empirical data substantiates the theoretical framework proposed earlier.', keywords: ['empirical', 'substantiates', 'theoretical', 'framework'], translation: '實證數據證實了先前提出的理論框架。', vocabulary: [{ word: 'empirical', meaning: '實證的' }, { word: 'substantiates', meaning: '證實' }, { word: 'theoretical', meaning: '理論的' }, { word: 'framework', meaning: '框架' }] },
                        { level: 'C1', context: '商務', text: 'Organizational resilience hinges upon adaptive leadership and strategic foresight.', keywords: ['resilience', 'hinges', 'adaptive', 'foresight'], translation: '組織韌性取決於適應性領導和戰略遠見。', vocabulary: [{ word: 'resilience', meaning: '韌性' }, { word: 'hinges', meaning: '取決於' }, { word: 'adaptive', meaning: '適應性的' }, { word: 'foresight', meaning: '遠見' }] },
                        { level: 'C1', context: '科技', text: 'Algorithmic bias perpetuates systemic inequalities in automated decision-making.', keywords: ['algorithmic', 'bias', 'perpetuates', 'systemic', 'inequalities'], translation: '算法偏見在自動化決策中延續了系統性不平等。', vocabulary: [{ word: 'algorithmic', meaning: '算法的' }, { word: 'bias', meaning: '偏見' }, { word: 'perpetuates', meaning: '延續' }, { word: 'systemic', meaning: '系統性的' }, { word: 'inequalities', meaning: '不平等' }] },
                        { level: 'C1', context: '學術', text: 'The treatise delineates the conceptual distinctions between ethical paradigms.', keywords: ['treatise', 'delineates', 'conceptual', 'distinctions', 'paradigms'], translation: '這篇論文闡述了倫理範式之間的概念區別。', vocabulary: [{ word: 'treatise', meaning: '論文' }, { word: 'delineates', meaning: '闡述' }, { word: 'conceptual', meaning: '概念的' }, { word: 'distinctions', meaning: '區別' }, { word: 'paradigms', meaning: '範式' }] },
                        { level: 'C1', context: '商務', text: 'Fiduciary responsibilities demand unwavering commitment to stakeholder interests.', keywords: ['fiduciary', 'unwavering', 'commitment', 'stakeholder'], translation: '受託責任要求對利益相關者利益的不懈承諾。', vocabulary: [{ word: 'fiduciary', meaning: '受託的' }, { word: 'unwavering', meaning: '不懈的' }, { word: 'commitment', meaning: '承諾' }, { word: 'stakeholder', meaning: '利益相關者' }] },
                        { level: 'C1', context: '學術', text: 'The polemic discourse surrounding this topic remains contentious among academics.', keywords: ['polemic', 'discourse', 'contentious', 'academics'], translation: '圍繞這個話題的爭論性話語在學術界仍然存在爭議。', vocabulary: [{ word: 'polemic', meaning: '爭論性的' }, { word: 'discourse', meaning: '話語' }, { word: 'contentious', meaning: '有爭議的' }, { word: 'academics', meaning: '學術界' }] },
                        { level: 'C1', context: '科技', text: 'Blockchain technology epitomizes decentralized ledger systems with immutable records.', keywords: ['blockchain', 'epitomizes', 'decentralized', 'immutable'], translation: '區塊鏈技術體現了具有不可變記錄的去中心化帳本系統。', vocabulary: [{ word: 'blockchain', meaning: '區塊鏈' }, { word: 'epitomizes', meaning: '體現' }, { word: 'decentralized', meaning: '去中心化的' }, { word: 'immutable', meaning: '不可變的' }] },
                        { level: 'C1', context: '學術', text: 'The juxtaposition of these theoretical constructs illuminates underlying contradictions.', keywords: ['juxtaposition', 'constructs', 'illuminates', 'contradictions'], translation: '這些理論建構的並置揭示了潛在的矛盾。', vocabulary: [{ word: 'juxtaposition', meaning: '並置' }, { word: 'constructs', meaning: '建構' }, { word: 'illuminates', meaning: '揭示' }, { word: 'contradictions', meaning: '矛盾' }] },
                        { level: 'C1', context: '商務', text: 'Synergistic collaborations catalyze innovation and expedite market penetration.', keywords: ['synergistic', 'collaborations', 'catalyze', 'expedite', 'penetration'], translation: '協同合作催化創新並加速市場滲透。', vocabulary: [{ word: 'synergistic', meaning: '協同的' }, { word: 'collaborations', meaning: '合作' }, { word: 'catalyze', meaning: '催化' }, { word: 'expedite', meaning: '加速' }, { word: 'penetration', meaning: '滲透' }] },
                        
                        // 文法練習 - C1 級別 (5句)
                        { level: 'C1', context: '文法', text: 'Seldom have I encountered such dedication and professionalism.', keywords: ['inversion', 'seldom', 'have'], translation: '我很少遇到如此奉獻和專業精神。', vocabulary: [{ word: 'inversion', meaning: '倒裝' }, { word: 'seldom', meaning: '很少' }, { word: 'have', meaning: '有' }] },
                        { level: 'C1', context: '文法', text: 'Should you require further assistance, please do not hesitate to contact us.', keywords: ['inversion', 'should', 'formal'], translation: '如果您需要進一步協助，請隨時與我們聯繫。', vocabulary: [{ word: 'inversion', meaning: '倒裝' }, { word: 'should', meaning: '如果' }, { word: 'formal', meaning: '正式的' }] },
                        { level: 'C1', context: '文法', text: 'The phenomenon, unprecedented in its scope, has baffled researchers.', keywords: ['apposition', 'unprecedented', 'scope'], translation: '這個現象在其範圍內是前所未有的，令研究人員困惑。', vocabulary: [{ word: 'apposition', meaning: '同位語' }, { word: 'unprecedented', meaning: '前所未有的' }, { word: 'scope', meaning: '範圍' }] },
                        { level: 'C1', context: '文法', text: 'Had it not been for your intervention, the situation would have deteriorated.', keywords: ['inversion', 'had it not been', 'conditional'], translation: '如果不是您的干預，情況會惡化。', vocabulary: [{ word: 'inversion', meaning: '倒裝' }, { word: 'had it not been', meaning: '如果不是' }, { word: 'conditional', meaning: '條件句' }] },
                        { level: 'C1', context: '文法', text: 'Notwithstanding the challenges, the team persevered with unwavering resolve.', keywords: ['notwithstanding', 'formal connector'], translation: '儘管面臨挑戰，團隊以堅定的決心堅持不懈。', vocabulary: [{ word: 'notwithstanding', meaning: '儘管' }, { word: 'formal connector', meaning: '正式連接詞' }] },
                        
                        // 片語練習 - C1 級別 (5句)
                        { level: 'C1', context: '片語', text: 'The government clamped down on tax evasion with stringent penalties.', keywords: ['clamp down on', 'suppress forcefully'], translation: '政府對逃稅行為採取了嚴厲的處罰措施。', vocabulary: [{ word: 'clamp down on', meaning: '嚴厲打擊' }, { word: 'suppress forcefully', meaning: '強力鎮壓' }] },
                        { level: 'C1', context: '片語', text: 'His unethical behavior flew in the face of company policy.', keywords: ['fly in the face of', 'contradict'], translation: '他的不道德行為違反了公司政策。', vocabulary: [{ word: 'fly in the face of', meaning: '違反' }, { word: 'contradict', meaning: '矛盾' }] },
                        { level: 'C1', context: '片語', text: 'The new evidence bears out the hypothesis we proposed earlier.', keywords: ['bear out', 'confirm', 'substantiate'], translation: '新證據證實了我們先前提出的假說。', vocabulary: [{ word: 'bear out', meaning: '證實' }, { word: 'confirm', meaning: '確認' }, { word: 'substantiate', meaning: '證實' }] },
                        { level: 'C1', context: '片語', text: 'The committee will mull over the proposal before making a decision.', keywords: ['mull over', 'consider carefully'], translation: '委員會將仔細考慮這個提議，然後做出決定。', vocabulary: [{ word: 'mull over', meaning: '仔細考慮' }, { word: 'consider carefully', meaning: '仔細考慮' }] },
                        { level: 'C1', context: '片語', text: 'The scandal brought about the downfall of several high-ranking officials.', keywords: ['bring about', 'cause', 'result in'], translation: '這起醜聞導致幾名高級官員下台。', vocabulary: [{ word: 'bring about', meaning: '導致' }, { word: 'cause', meaning: '造成' }, { word: 'result in', meaning: '導致' }] },
                        
                        // 原有C1句子
                        {
                            text: "The paradigm shift towards renewable energy necessitates comprehensive policy restructuring and substantial infrastructure investment.",
                            translation: "向可再生能源的範式轉變需要全面的政策重組和大量的基礎設施投資。",
                            vocabulary: [
                                { word: "paradigm shift", meaning: "範式轉變" },
                                { word: "necessitates", meaning: "需要，必須" },
                                { word: "comprehensive", meaning: "全面的" },
                                { word: "substantial", meaning: "大量的" }
                            ]
                        },
                        {
                            text: "The philosophical implications of consciousness studies intersect with neuroscience, cognitive psychology, and existential inquiry.",
                            translation: "意識研究的哲學意涵與神經科學、認知心理學和存在主義探究相互交織。",
                            vocabulary: [
                                { word: "implications", meaning: "意涵，含義" },
                                { word: "intersect", meaning: "相互交織" },
                                { word: "cognitive", meaning: "認知的" },
                                { word: "existential", meaning: "存在主義的" }
                            ]
                        },
                        {
                            text: "Quantum computing represents an unprecedented technological breakthrough with profound ramifications for cryptography and data processing.",
                            translation: "量子計算代表著前所未有的技術突破，對密碼學和數據處理具有深遠影響。",
                            vocabulary: [
                                { word: "unprecedented", meaning: "前所未有的" },
                                { word: "breakthrough", meaning: "突破" },
                                { word: "ramifications", meaning: "影響，後果" },
                                { word: "cryptography", meaning: "密碼學" }
                            ]
                        },
                        {
                            text: "The intricate interplay between genetic predisposition and environmental factors determines phenotypic expression in complex organisms.",
                            translation: "遺傳傾向與環境因素之間複雜的相互作用決定了複雜生物體的表現型表達。",
                            vocabulary: [
                                { word: "intricate", meaning: "複雜的" },
                                { word: "interplay", meaning: "相互作用" },
                                { word: "predisposition", meaning: "傾向" },
                                { word: "phenotypic", meaning: "表現型的" }
                            ]
                        },
                        {
                            text: "Postcolonial literary criticism examines the lingering effects of imperialism on cultural identity and narrative construction.",
                            translation: "後殖民文學批評檢視帝國主義對文化身份和敘事建構的持續影響。",
                            vocabulary: [
                                { word: "postcolonial", meaning: "後殖民的" },
                                { word: "lingering", meaning: "持續的" },
                                { word: "imperialism", meaning: "帝國主義" },
                                { word: "narrative", meaning: "敘事" }
                            ]
                        },
                        {
                            text: "Epistemological frameworks in empirical research methodology require rigorous scrutiny of assumptions underlying knowledge claims.",
                            translation: "實證研究方法論中的認識論框架需要對知識主張基礎假設進行嚴格審視。",
                            vocabulary: [
                                { word: "epistemological", meaning: "認識論的" },
                                { word: "empirical", meaning: "實證的" },
                                { word: "methodology", meaning: "方法論" },
                                { word: "scrutiny", meaning: "審視" }
                            ]
                        },
                        {
                            text: "The phenomenological approach to consciousness elucidates the subjective experience of temporality and intentionality.",
                            translation: "對意識的現象學方法闡明了時間性和意向性的主觀體驗。",
                            vocabulary: [
                                { word: "phenomenological", meaning: "現象學的" },
                                { word: "elucidates", meaning: "闡明" },
                                { word: "temporality", meaning: "時間性" },
                                { word: "intentionality", meaning: "意向性" }
                            ]
                        },
                        {
                            text: "Macroeconomic stabilization policies must accommodate heterogeneous market dynamics and asymmetric information structures.",
                            translation: "宏觀經濟穩定政策必須適應異質市場動態和非對稱信息結構。",
                            vocabulary: [
                                { word: "macroeconomic", meaning: "宏觀經濟的" },
                                { word: "heterogeneous", meaning: "異質的" },
                                { word: "asymmetric", meaning: "非對稱的" },
                                { word: "structures", meaning: "結構" }
                            ]
                        },
                        {
                            text: "Neuroplasticity research demonstrates the brain's capacity for synaptic reorganization throughout the human lifespan.",
                            translation: "神經可塑性研究證明了大腦在人類整個生命週期中突觸重組的能力。",
                            vocabulary: [
                                { word: "neuroplasticity", meaning: "神經可塑性" },
                                { word: "synaptic", meaning: "突觸的" },
                                { word: "reorganization", meaning: "重組" },
                                { word: "lifespan", meaning: "生命週期" }
                            ]
                        },
                        {
                            text: "Poststructuralist discourse analysis deconstructs hegemonic narratives to reveal underlying power dynamics.",
                            translation: "後結構主義話語分析解構霸權敘事以揭示潛在的權力動態。",
                            vocabulary: [
                                { word: "poststructuralist", meaning: "後結構主義的" },
                                { word: "deconstructs", meaning: "解構" },
                                { word: "hegemonic", meaning: "霸權的" },
                                { word: "dynamics", meaning: "動態" }
                            ]
                        }
                    ]
                };
                
                this.init();
            }

            init() {
                this.cacheElements();
                this.bindEvents();
                this.applyFilters();
                this.loadSentence();
                this.initSpeech();
                this.initPerformanceMonitoring();
                this.trackUserEngagement();
            }

            applyFilters() {
                this.filteredSentences = [];
                
                // 收集所有句子
                const allSentences = [];
                Object.keys(this.sentences).forEach(level => {
                    this.sentences[level].forEach(sentence => {
                        // 確保句子有level和context屬性
                        if (!sentence.level) sentence.level = level;
                        if (!sentence.context) sentence.context = '日常對話';
                        allSentences.push(sentence);
                    });
                });
                
                // 應用過濾器
                this.filteredSentences = allSentences.filter(sentence => {
                    const levelMatch = this.levelFilter === 'all' || sentence.level === this.levelFilter;
                    const contextMatch = this.contextFilter === 'all' || sentence.context === this.contextFilter;
                    return levelMatch && contextMatch;
                });
                
                // 更新句子計數
                this.elements.count.textContent = this.filteredSentences.length;
                
                // 重置當前句子索引
                this.currentSentenceIndex = 0;
                this.completed = 0;
            }

            getCurrentSentence() {
                if (this.filteredSentences.length === 0) {
                    return null;
                }
                return this.filteredSentences[this.currentSentenceIndex];
            }

            cacheElements() {
                // Cache frequently used DOM elements
                this.elements = {
                    input: document.getElementById('typing-input'),
                    nextBtn: document.getElementById('next-btn'),
                    playSentenceBtn: document.getElementById('play-sentence'),
                    playSlowBtn: document.getElementById('play-slow'),
                    speedSlider: document.getElementById('speed-slider'),
                    speedValue: document.getElementById('speed-value'),
                    hideChineseBtn: document.getElementById('hide-chinese'),
                    hideEnglishBtn: document.getElementById('hide-english'),
                    wpm: document.getElementById('wpm'),
                    accuracy: document.getElementById('accuracy'),
                    progress: document.getElementById('progress'),
                    progressFill: document.getElementById('progress-fill'),
                    feedback: document.getElementById('feedback'),
                    targetSentence: document.getElementById('target-sentence'),
                    translation: document.getElementById('translation'),
                    vocabulary: document.getElementById('vocabulary'),
                    vocabContent: document.getElementById('vocab-content'),
                    contextFilter: document.getElementById('contextFilter'),
                    count: document.getElementById('count')
                };
            }

            initSpeech() {
                // Check if speech synthesis is available
                if ('speechSynthesis' in window) {
                    this.speechAvailable = true;
                } else {
                    this.speechAvailable = false;
                    console.log('Speech synthesis not available');
                }
            }

            initPerformanceMonitoring() {
                // Monitor typing performance
                this.performanceMetrics.typingStartTime = Date.now();
                
                // Monitor page load performance
                if ('performance' in window) {
                    window.addEventListener('load', () => {
                        setTimeout(() => {
                            const perfData = performance.getEntriesByType('navigation')[0];
                            const timing = {
                                domContentLoaded: perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart,
                                loadComplete: perfData.loadEventEnd - perfData.loadEventStart,
                                totalLoadTime: perfData.loadEventEnd - perfData.fetchStart
                            };
                            
                            console.log('Performance Metrics:', timing);
                            this.trackEvent('performance_metrics', timing);
                        }, 0);
                    });
                }

                // Monitor typing accuracy and speed
                this.performanceObserver = new PerformanceObserver((list) => {
                    for (const entry of list.getEntries()) {
                        if (entry.entryType === 'measure') {
                            console.log(`${entry.name}: ${entry.duration}ms`);
                            this.trackEvent('performance_measure', {
                                name: entry.name,
                                duration: entry.duration
                            });
                        }
                    }
                });

                try {
                    this.performanceObserver.observe({ entryTypes: ['measure'] });
                } catch (e) {
                    console.log('Performance Observer not supported');
                }

                // Monitor memory usage (if available)
                if ('memory' in performance) {
                    setInterval(() => {
                        const memoryInfo = {
                            usedJSHeapSize: performance.memory.usedJSHeapSize,
                            totalJSHeapSize: performance.memory.totalJSHeapSize,
                            jsHeapSizeLimit: performance.memory.jsHeapSizeLimit
                        };
                        
                        // Only log if memory usage is high
                        if (memoryInfo.usedJSHeapSize / memoryInfo.jsHeapSizeLimit > 0.8) {
                            console.warn('High memory usage detected:', memoryInfo);
                            this.trackEvent('high_memory_usage', memoryInfo);
                        }
                    }, 30000); // Check every 30 seconds
                }
            }

            trackUserEngagement() {
                // Track typing sessions for analytics (if implemented)
                let sessionStart = Date.now();
                let totalTyped = 0;
                
                window.addEventListener('beforeunload', () => {
                    // Could send analytics data here
                    const sessionDuration = (Date.now() - sessionStart) / 1000;
                    localStorage.setItem('lastSession', JSON.stringify({
                        duration: sessionDuration,
                        typed: totalTyped,
                        level: this.currentLevel,
                        date: new Date().toISOString()
                    }));
                });
            }

            bindEvents() {
                // Difficulty selection
                document.querySelectorAll('.difficulty-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelector('.difficulty-btn.active').classList.remove('active');
                        e.target.classList.add('active');
                        this.currentLevel = e.target.dataset.level;
                        this.levelFilter = e.target.dataset.level; // 同步更新 levelFilter
                        this.currentSentenceIndex = 0;
                        this.completed = 0;
                        this.applyFilters(); // 重新應用過濾器
                        this.loadSentence();
                        
                        // Analytics tracking
                        this.trackEvent('difficulty_changed', { level: this.currentLevel });
                    });
                });

                // Filter events
                this.elements.contextFilter.addEventListener('change', (e) => {
                    this.contextFilter = e.target.value;
                    this.applyFilters();
                    this.loadSentence();
                    this.trackEvent('context_filter_changed', { filter: this.contextFilter });
                });

                // Display options
                this.elements.hideChineseBtn.addEventListener('click', (e) => {
                    this.hideChinese = !this.hideChinese;
                    e.target.classList.toggle('active', this.hideChinese);
                    this.updateDisplay();
                    this.trackEvent('hide_chinese_toggled', { hidden: this.hideChinese });
                });

                this.elements.hideEnglishBtn.addEventListener('click', (e) => {
                    this.hideEnglish = !this.hideEnglish;
                    e.target.classList.toggle('active', this.hideEnglish);
                    this.updateDisplay();
                    this.trackEvent('hide_english_toggled', { hidden: this.hideEnglish });
                });

                // Typing input with debounce
                const debouncedTyping = this.debounce((value) => {
                    this.handleTyping(value);
                }, 50); // 50ms debounce for smooth typing
                
                this.elements.input.addEventListener('input', (e) => {
                    this.performanceMetrics.keystrokes++;
                    debouncedTyping(e.target.value);
                });

                this.elements.input.addEventListener('keydown', (e) => {
                    if (e.key === 'Tab') {
                        e.preventDefault();
                    }
                });

                this.elements.input.addEventListener('focus', () => {
                    this.trackEvent('input_focused');
                });

                // Next button
                this.elements.nextBtn.addEventListener('click', () => {
                    this.nextSentence();
                    this.trackEvent('next_sentence', { 
                        level: this.currentLevel, 
                        sentence: this.currentSentenceIndex 
                    });
                });

                // Speech controls
                this.elements.playSentenceBtn.addEventListener('click', () => {
                    const current = this.getCurrentSentence();
                    if (current) {
                        this.speakText(current.text, this.speechRate);
                    }
                });

                this.elements.playSlowBtn.addEventListener('click', () => {
                    const current = this.getCurrentSentence();
                    if (current) {
                        this.speakText(current.text, 0.6);
                    }
                });

                this.elements.speedSlider.addEventListener('input', (e) => {
                    this.speechRate = parseFloat(e.target.value);
                    this.elements.speedValue.textContent = this.speechRate + 'x';
                });

                // Enhanced keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    // Prevent default for our custom shortcuts
                    if (e.ctrlKey || e.altKey) {
                        switch (e.key) {
                            case 'Enter':
                                if (e.ctrlKey) {
                                    e.preventDefault();
                                    if (!this.elements.nextBtn.disabled) {
                                        this.nextSentence();
                                    }
                                }
                                break;
                            case 'p':
                                if (e.ctrlKey) {
                                    e.preventDefault();
                                    this.elements.playSentenceBtn.click();
                                }
                                break;
                            case 's':
                                if (e.ctrlKey) {
                                    e.preventDefault();
                                    this.elements.playSlowBtn.click();
                                }
                                break;
                            case '1':
                                if (e.altKey) {
                                    e.preventDefault();
                                    document.querySelector('[data-level="B1"]').click();
                                }
                                break;
                            case '2':
                                if (e.altKey) {
                                    e.preventDefault();
                                    document.querySelector('[data-level="B2"]').click();
                                }
                                break;
                            case '3':
                                if (e.altKey) {
                                    e.preventDefault();
                                    document.querySelector('[data-level="C1"]').click();
                                }
                                break;
                            case 'Tab':
                                // Enhanced tab navigation
                                if (e.shiftKey) {
                                    this.focusPreviousElement();
                                } else {
                                    this.focusNextElement();
                                }
                                e.preventDefault();
                                break;
                            case 'Escape':
                                e.preventDefault();
                                this.elements.input.focus();
                                break;
                        }
                    }
                    
                    // Space bar to play/pause audio when focused on audio controls
                    if (e.key === ' ' && e.target.classList.contains('audio-btn')) {
                        e.preventDefault();
                        e.target.click();
                    }
                });
            }

            focusNextElement() {
                const focusableElements = this.getFocusableElements();
                const currentIndex = focusableElements.indexOf(document.activeElement);
                const nextIndex = (currentIndex + 1) % focusableElements.length;
                focusableElements[nextIndex].focus();
            }

            focusPreviousElement() {
                const focusableElements = this.getFocusableElements();
                const currentIndex = focusableElements.indexOf(document.activeElement);
                const prevIndex = currentIndex === 0 ? focusableElements.length - 1 : currentIndex - 1;
                focusableElements[prevIndex].focus();
            }

            getFocusableElements() {
                const focusableSelectors = [
                    'button:not([disabled])',
                    'input:not([disabled])',
                    'textarea:not([disabled])',
                    'select:not([disabled])',
                    'a[href]',
                    '[tabindex]:not([tabindex="-1"])'
                ];
                
                return Array.from(document.querySelectorAll(focusableSelectors.join(', ')))
                    .filter(element => {
                        return element.offsetParent !== null && // Element is visible
                               !element.hasAttribute('aria-hidden') &&
                               element.getAttribute('tabindex') !== '-1';
                    });
            }

            trackEvent(eventName, data = {}) {
                // Simple event tracking (could be replaced with Google Analytics)
                try {
                    if (typeof gtag !== 'undefined') {
                        gtag('event', eventName, data);
                    }
                } catch (e) {
                    // Silently fail if analytics not available
                }
            }

            speakText(text, rate = 0.9) {
                if (!this.speechAvailable) {
                    alert('抱歉，您的瀏覽器不支援語音功能');
                    return;
                }

                // Cancel any ongoing speech
                speechSynthesis.cancel();

                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US';
                utterance.rate = rate;
                utterance.pitch = 1;
                utterance.volume = 0.8;

                // Visual feedback
                const playBtn = this.elements.playSentenceBtn;
                const slowBtn = this.elements.playSlowBtn;
                
                utterance.onstart = () => {
                    if (rate > 0.7) {
                        playBtn.textContent = '⏸️ 播放中...';
                        playBtn.classList.add('playing');
                    } else {
                        slowBtn.textContent = '⏸️ 慢速播放中...';
                        slowBtn.classList.add('playing');
                    }
                };

                utterance.onend = () => {
                    playBtn.textContent = '🔊 播放句子';
                    slowBtn.textContent = '🐌 慢速播放';
                    playBtn.classList.remove('playing');
                    slowBtn.classList.remove('playing');
                };

                utterance.onerror = () => {
                    playBtn.textContent = '🔊 播放句子';
                    slowBtn.textContent = '🐌 慢速播放';
                    playBtn.classList.remove('playing');
                    slowBtn.classList.remove('playing');
                    console.log('Speech synthesis error');
                };

                this.currentSpeech = utterance;
                speechSynthesis.speak(utterance);
            }

            loadSentence() {
                if (this.filteredSentences.length === 0) {
                    this.elements.targetSentence.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">沒有符合條件的句子，請調整過濾器設定。</div>';
                    this.elements.translation.textContent = '';
                    this.elements.vocabulary.style.display = 'none';
                    this.elements.nextBtn.disabled = true;
                    return;
                }
                
                if (this.currentSentenceIndex >= this.filteredSentences.length) {
                    this.currentSentenceIndex = 0;
                }
                
                const currentSentence = this.filteredSentences[this.currentSentenceIndex];
                const sentenceElement = this.elements.targetSentence;
                const translationElement = this.elements.translation;
                const vocabElement = this.elements.vocabulary;
                const vocabContent = this.elements.vocabContent;

                // Display sentence with individual characters
                sentenceElement.innerHTML = currentSentence.text
                    .split('')
                    .map(char => `<span class="char">${char === ' ' ? '&nbsp;' : char}</span>`)
                    .join('');

                translationElement.textContent = currentSentence.translation;

                // Show vocabulary with audio buttons
                vocabContent.innerHTML = currentSentence.vocabulary
                    .map(item => `
                        <div class="vocab-item">
                            <span class="vocab-word" onclick="typingPractice.speakText('${item.word}', 0.8)">${item.word}</span>
                            <button class="word-audio-btn" onclick="typingPractice.speakText('${item.word}', 0.8)">🔊</button>
                            : ${item.meaning}
                        </div>
                    `).join('');
                vocabElement.style.display = 'block';

                // Reset input and states
                this.elements.input.value = '';
                this.elements.input.focus();
                this.elements.nextBtn.disabled = true;
                this.elements.feedback.textContent = '';
                this.currentCharIndex = 0;
                this.startTime = null;
                this.errors = 0;
                this.totalChars = currentSentence.text.length;

                this.updateProgress();
                this.updateCharacterDisplay();
                this.updateDisplay();
                
                // Stop any ongoing speech
                if (this.currentSpeech) {
                    speechSynthesis.cancel();
                }
                
                // Update page title for SEO
                const currentSentenceForTitle = this.getCurrentSentence();
                if (currentSentenceForTitle) {
                    document.title = `英文打字練習 ${currentSentenceForTitle.level}級 - 句子 ${this.currentSentenceIndex + 1} | English Typing Practice`;
                } else {
                    document.title = `英文打字練習 | English Typing Practice`;
                }
            }

            handleTyping(inputValue) {
                performance.mark('typing-start');
                
                if (!this.startTime && inputValue.length > 0) {
                    this.startTime = Date.now();
                    this.performanceMetrics.typingStartTime = this.startTime;
                }

                const current = this.getCurrentSentence();
                if (!current) return;
                
                const targetText = current.text;
                const chars = document.querySelectorAll('.char');

                // Reset all character classes
                chars.forEach(char => {
                    char.classList.remove('correct', 'incorrect', 'current');
                });

                let correctChars = 0;
                let hasError = false;

                // Check each character
                for (let i = 0; i < Math.max(inputValue.length, targetText.length); i++) {
                    if (i < inputValue.length && i < targetText.length) {
                        if (inputValue[i] === targetText[i]) {
                            chars[i].classList.add('correct');
                            correctChars++;
                        } else {
                            chars[i].classList.add('incorrect');
                            hasError = true;
                            if (i >= this.currentCharIndex) {
                                this.errors++;
                                this.performanceMetrics.errors++;
                                this.currentCharIndex = i + 1;
                            }
                        }
                    }
                }

                // Mark current character
                if (inputValue.length < targetText.length) {
                    chars[inputValue.length].classList.add('current');
                }

                // Update stats in real-time
                if (this.startTime && inputValue.length > 0) {
                    this.updateStats(inputValue.length, correctChars);
                }

                // Check if completed
                if (inputValue === targetText) {
                    this.completeCurrentSentence();
                }
                
                performance.mark('typing-end');
                performance.measure('typing-processing', 'typing-start', 'typing-end');
            }

            updateStats(typedLength, correctChars) {
                if (this.startTime && typedLength > 0) {
                    const timeElapsed = (Date.now() - this.startTime) / 1000 / 60; // minutes
                    // Calculate net WPM (subtract errors)
                    const netWPM = Math.max(0, Math.round(((correctChars) / 5) / timeElapsed)) || 0;
                    
                    this.elements.wpm.textContent = netWPM;
                }

                const accuracy = typedLength > 0 ? Math.round((correctChars / typedLength) * 100) : 100;
                this.elements.accuracy.textContent = accuracy + '%';
            }

            completeCurrentSentence() {
                this.completed++;
                this.elements.nextBtn.disabled = false;
                
                const accuracy = parseInt(this.elements.accuracy.textContent);
                const wpm = parseInt(this.elements.wpm.textContent);
                
                let feedback = '';
                let feedbackClass = '';
                
                if (accuracy >= 98 && wpm >= 40) {
                    feedback = '🌟 優秀！準確率和速度都很棒！';
                    feedbackClass = 'excellent';
                } else if (accuracy >= 95 && wpm >= 30) {
                    feedback = '👍 很好！繼續保持！';
                    feedbackClass = 'good';
                } else if (accuracy >= 90 && wpm >= 20) {
                    feedback = '📈 不錯！還有進步空間！';
                    feedbackClass = 'fair';
                } else {
                    feedback = '💪 繼續練習，你會越來越好的！';
                    feedbackClass = 'poor';
                }
                
                const feedbackElement = this.elements.feedback;
                feedbackElement.textContent = feedback;
                feedbackElement.className = 'feedback ' + feedbackClass;

                this.updateProgress();
                
                // Track completion
                this.trackEvent('sentence_completed', {
                    level: this.currentLevel,
                    sentence: this.currentSentenceIndex,
                    wpm: wpm,
                    accuracy: accuracy,
                    time: this.startTime ? (Date.now() - this.startTime) / 1000 : 0
                });
            }

            nextSentence() {
                this.currentSentenceIndex++;
                if (this.currentSentenceIndex >= this.filteredSentences.length) {
                    this.currentSentenceIndex = 0;
                    
                    // Track level completion
                    this.trackEvent('level_completed', {
                        level: this.currentLevel,
                        totalSentences: this.filteredSentences.length
                    });
                }
                this.loadSentence();
            }

            updateProgress() {
                const total = this.filteredSentences.length;
                const current = this.currentSentenceIndex + 1;
                this.elements.progress.textContent = `${current}/${total}`;
                
                const percentage = total > 0 ? (current / total) * 100 : 0;
                this.elements.progressFill.style.width = percentage + '%';
            }

            updateDisplay() {
                // 更新中文翻譯顯示
                if (this.hideChinese) {
                    this.elements.translation.style.display = 'none';
                } else {
                    this.elements.translation.style.display = 'block';
                }

                // 更新英文句子顯示
                if (this.hideEnglish) {
                    this.elements.targetSentence.style.display = 'none';
                } else {
                    this.elements.targetSentence.style.display = 'block';
                }
            }

            updateCharacterDisplay() {
                const chars = document.querySelectorAll('.char');
                chars.forEach((char, index) => {
                    if (index === 0) {
                        char.classList.add('current');
                    }
                });
            }
        }

        // Initialize the app
        let typingPractice;
        document.addEventListener('DOMContentLoaded', () => {
            typingPractice = new TypingPractice();
            
            // Service Worker for PWA capabilities
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available, show update notification
                                    showUpdateNotification();
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.error('Service Worker registration failed:', error);
                    });
                
                // Listen for service worker messages
                navigator.serviceWorker.addEventListener('message', (event) => {
                    if (event.data && event.data.type === 'CACHE_UPDATED') {
                        console.log('Cache updated:', event.data.version);
                    }
                });
            }
        });

        // Update notification function
        function showUpdateNotification() {
            if ('Notification' in window && Notification.permission === 'granted') {
                const notification = new Notification('英文打字練習更新', {
                    body: '新版本已準備就緒，點擊重新載入頁面以使用最新功能！',
                    icon: '/icons/icon-192x192.png',
                    tag: 'app-update',
                    requireInteraction: true,
                    actions: [
                        {
                            action: 'reload',
                            title: '重新載入'
                        },
                        {
                            action: 'dismiss',
                            title: '稍後'
                        }
                    ]
                });
                
                notification.onclick = () => {
                    window.location.reload();
                    notification.close();
                };
                
                // Auto-close after 10 seconds
                setTimeout(() => {
                    notification.close();
                }, 10000);
            }
        }

        // Performance optimization
        window.addEventListener('load', () => {
            // Preload critical resources for better performance
            if (typingPractice && typingPractice.speechAvailable) {
                // Preload speech synthesis voices
                speechSynthesis.getVoices();
            }
            
            // Request notification permission for PWA features
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        });
    </script>

    <!-- Schema markup for better SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Course",
        "name": "免費英文打字練習課程",
        "description": "提供A2到C1級別的英文打字練習，包含WPM測試、準確率統計和詞彙學習",
        "provider": {
            "@type": "Organization",
            "name": "English Typing Practice"
        },
        "educationalLevel": ["Elementary", "Intermediate", "Upper-Intermediate", "Advanced"],
        "teaches": ["English Typing", "Keyboard Skills", "English Vocabulary"],
        "courseMode": "online",
        "isAccessibleForFree": true,
        "inLanguage": ["zh-TW", "en"],
        "coursePrerequisites": "基礎英語能力",
        "timeRequired": "PT15M",
        "typicalAgeRange": "13-99",
        "audience": {
            "@type": "EducationalAudience",
            "educationalRole": ["student", "self-learner"]
        }
    }
    </script>

    <!-- FAQ Schema for rich snippets -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "這個英文打字練習網站是免費的嗎？",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "是的，我們的英文打字練習網站完全免費，無需註冊或付費即可使用所有功能。"
                }
            },
            {
                "@type": "Question", 
                "name": "有哪些難度級別可以選擇？",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "我們提供A2（初中級）、B1（中級）、B2（中高級）、C1（高級）四個級別的英文句子練習，適合不同程度的學習者。"
                }
            },
            {
                "@type": "Question",
                "name": "如何提升英文打字速度？",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "建議每天練習15-30分鐘，專注於準確率而非速度，熟悉鍵盤位置後速度自然會提升。我們的工具會即時顯示WPM和準確率幫助您追蹤進度。"
                }
            }
        ]
    }
    </script>
</body>
</html>
